<!-- æˆ‘çš„ä¸¾æŠ¥é¡µé¢ -->
<view class="my-reports-page">
    <view class="header">
        <view class="back-btn" bindtap="goBack">
            <text>â† è¿”å›</text>
        </view>
        <view class="title">æˆ‘çš„ä¸¾æŠ¥</view>
    </view>

    <!-- ç”¨æˆ·ä¿¡æ¯ -->
    <view class="user-section">
        <view class="user-avatar">
            <text class="avatar-emoji">{{currentUser.avatar || 'ğŸ‘·'}}</text>
        </view>
        <view class="user-info">
            <view class="name">{{currentUser.name || 'å¾®ä¿¡ç”¨æˆ·'}}</view>
            <view class="dept">{{currentUser.department || 'æœªè®¾ç½®éƒ¨é—¨'}} Â· ç¬¬{{currentSection}}æ ‡æ®µ</view>
        </view>
    </view>

    <!-- çŠ¶æ€ç­›é€‰ -->
    <view class="filter-tabs">
        <view class="filter-tab {{currentFilter === 'processing' ? 'active' : ''}}" bindtap="filterReports" data-filter="processing">
            <text>å¤„ç†ä¸­ ({{processingCount}})</text>
        </view>
        <view class="filter-tab {{currentFilter === 'completed' ? 'active' : ''}}" bindtap="filterReports" data-filter="completed">
            <text>å·²åŠç»“ ({{completedCount}})</text>
        </view>
        <view class="filter-tab {{currentFilter === 'evaluated' ? 'active' : ''}}" bindtap="filterReports" data-filter="evaluated">
            <text>å·²è¯„ä»· ({{evaluatedCount}})</text>
        </view>
        <view class="filter-tab {{currentFilter === 'all' ? 'active' : ''}}" bindtap="filterReports" data-filter="all">
            <text>å…¨éƒ¨ ({{reports.length}})</text>
        </view>
    </view>

    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="loading" wx:if="{{loading}}">
        <text>åŠ è½½ä¸­...</text>
    </view>

    <!-- ä¸¾æŠ¥åˆ—è¡¨ -->
    <view class="reports-list" wx:else>
        <view class="report-item" wx:for="{{filteredReports}}" wx:key="id" bindtap="viewReportDetail" data-id="{{item.id}}">
            <view class="report-header">
                <view class="report-type">{{item.hazardType}}</view>
                <view class="report-priority" wx:if="{{item.priority === 'high'}}">ç´§æ€¥</view>
            </view>
            <view class="report-content">
                <view class="report-desc">{{item.description}}</view>

                <!-- æ˜¾ç¤ºå›¾ç‰‡ -->
                <view class="report-images" wx:if="{{item.initialImages && item.initialImages.length > 0}}">
                    <image
                        class="report-image"
                        src="{{item.initialImages[0]}}"
                        mode="aspectFill"
                        bindtap="viewImage"
                        data-src="{{item.initialImages[0]}}"
                        data-list="{{item.initialImages}}"
                    ></image>
                </view>

                <view class="report-meta">
                    <text class="reporter">ä¸¾æŠ¥äºº: {{item.reporter}}</text>
                    <text class="time">{{item.reportTime}}</text>
                </view>
            </view>
        </view>

        <!-- ç©ºçŠ¶æ€ -->
        <view class="empty-state" wx:if="{{filteredReports.length === 0}}">
            <text>æš‚æ— ä¸¾æŠ¥è®°å½•</text>
        </view>
    </view>
</view>